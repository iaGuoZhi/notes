<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js ayu">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Notes</title>
        
        <meta name="robots" content="noindex" />
        

        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" rel="stylesheet" type="text/css">
        <link href="https://fonts.googleapis.com/css?family=Source+Code+Pro:500" rel="stylesheet" type="text/css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        

        
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "ayu" : "ayu";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('ayu')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div id="sidebar-scrollbox" class="sidebar-scrollbox">
                <ol class="chapter"><li class="expanded "><a href="ld.so.html"><strong aria-hidden="true">1.</strong> ld.so</a></li><li class="expanded "><a href="git.html"><strong aria-hidden="true">2.</strong> git</a></li><li class="expanded "><a href="gdb.html"><strong aria-hidden="true">3.</strong> gdb</a></li><li class="expanded "><a href="radare2.html"><strong aria-hidden="true">4.</strong> radare2</a></li><li class="expanded "><a href="emacs.html"><strong aria-hidden="true">5.</strong> emacs</a></li><li class="expanded "><a href="fish.html"><strong aria-hidden="true">6.</strong> fish</a></li><li class="expanded "><a href="strace.html"><strong aria-hidden="true">7.</strong> strace</a></li><li class="expanded "><a href="lsof.html"><strong aria-hidden="true">8.</strong> lsof</a></li><li class="expanded "><a href="pidstat.html"><strong aria-hidden="true">9.</strong> pidstat</a></li><li class="expanded "><a href="time.html"><strong aria-hidden="true">10.</strong> time</a></li><li class="expanded "><a href="pmap.html"><strong aria-hidden="true">11.</strong> pmap</a></li><li class="expanded "><a href="pstack.html"><strong aria-hidden="true">12.</strong> pstack</a></li><li class="expanded "><a href="perf.html"><strong aria-hidden="true">13.</strong> perf</a></li><li class="expanded "><a href="oprofile.html"><strong aria-hidden="true">14.</strong> OProfile</a></li><li class="expanded "><a href="od.html"><strong aria-hidden="true">15.</strong> od</a></li><li class="expanded "><a href="xxd.html"><strong aria-hidden="true">16.</strong> xxd</a></li><li class="expanded "><a href="readelf.html"><strong aria-hidden="true">17.</strong> readelf</a></li><li class="expanded "><a href="objdump.html"><strong aria-hidden="true">18.</strong> objdump</a></li><li class="expanded "><a href="nm.html"><strong aria-hidden="true">19.</strong> nm</a></li><li class="expanded "><a href="c++filt.html"><strong aria-hidden="true">20.</strong> c++filt</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                
                <div id="menu-bar" class="menu-bar">
                    <div id="menu-bar-sticky-container">
                        <div class="left-buttons">
                            <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                                <i class="fa fa-bars"></i>
                            </button>
                            <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                                <i class="fa fa-paint-brush"></i>
                            </button>
                            <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                                <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                                <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                                <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                                <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                                <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu (default)</button></li>
                            </ul>
                            
                            <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                                <i class="fa fa-search"></i>
                            </button>
                            
                        </div>

                        <h1 class="menu-title">Notes</h1>

                        <div class="right-buttons">
                            <a href="print.html" title="Print this book" aria-label="Print this book">
                                <i id="print-button" class="fa fa-print"></i>
                            </a>
                            
                        </div>
                    </div>
                </div>

                
                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" name="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1><a class="header" href="#ldso8" id="ldso8">ld.so(8)</a></h1>
<h2><a class="header" href="#environment-variables" id="environment-variables">Environment variables</a></h2>
<pre><code class="language-console">  LD_PRELOAD=&lt;l_so&gt;       colon separated list of libso's to be pre loaded
  LD_DEBUG=&lt;opts&gt;         comman separated list of debug options
          =help           list available options
          =libs           show library search path
          =files          processing of input files
          =symbols        show search path for symbol lookup
          =bindings       show against which definition a symbol is bound
</code></pre>
<h2><a class="header" href="#ld_preload-load--init-order" id="ld_preload-load--init-order">LD_PRELOAD load &amp; init order</a></h2>
<pre><code class="language-markdown">  &gt; ldd ./main
    &gt;&gt; libc.so.6 =&gt; /usr/lib/libc.so.6

  &gt; LD_PRELOAD=liba.so:libb.so ./main
             --&gt;
      preloaded in this order
             &lt;--
      initialized in this order

  - preload order determines the order libs are inserted into the link map

  - resulting link map:
      +------+    +------+    +------+    +------+
      | main | -&gt; | liba | -&gt; | libb | -&gt; | libc |
      +------+    +------+    +------+    +------+

  - see preload and init order in action
    &gt; LD_DEBUG=files LD_PRELOAD=liba.so:libb.so ./main
      # load order (-&gt; determines link map)
      &gt;&gt; file=liba.so [0];  generating link map
      &gt;&gt; file=libb.so [0];  generating link map
      &gt;&gt; file=libc.so.6 [0];  generating link map

      # init order
      &gt;&gt; calling init: /usr/lib/libc.so.6
      &gt;&gt; calling init: &lt;path&gt;/libb.so
      &gt;&gt; calling init: &lt;path&gt;/liba.so
      &gt;&gt; initialize program: ./main

  - see the symbol lookup in action and therefore the link map order
    &gt; LD_DEBUG=symbols,bindings LD_PRELOAD=liba.so:libb.so ./main
      &gt;&gt; symbol=memcpy;  lookup in file=./main [0]
      &gt;&gt; symbol=memcpy;  lookup in file=&lt;path&gt;/liba.so [0]
      &gt;&gt; symbol=memcpy;  lookup in file=&lt;path&gt;/libb.so [0]
      &gt;&gt; symbol=memcpy;  lookup in file=/usr/lib/libc.so.6 [0]
      &gt;&gt; binding file ./main [0] to /usr/lib/libc.so.6 [0]: normal symbol
         `memcpy' [GLIBC_2.14]
</code></pre>
<h2><a class="header" href="#dynamic-linking-x86_64" id="dynamic-linking-x86_64">dynamic linking (x86_64)</a></h2>
<pre><code class="language-makrdown">  - dynamic linking basically works via one indirect jump. It uses a
    combination of function trampolines (.plt) and a function pointer table
    (.got.plt). On the first call the trampoline sets up some metadata and
    then jumps to the ld.so runtime resolve function, which in turn patches
    the table with the correct function pointer.
      .plt ....... contains function trampolines, usually located in code
                   segment (rx permission)
      .got.plt ... hold the function pointer table

  - following r2 dump shows this
      - [0x00401030] indirect jump for 'puts' using function pointer in
        _GLOBAL_OFFSET_TABLE_[3]
      - initially points to instruction behind 'puts' trampoline [0x00401036]
      - this pushes relocation index and then jumps to the first trampoline
        [0x00401020]
      - the first trampoline jumps to _GLOBAL_OFFSET_TABLE_[2] which will be
        filled at program startup by the ld.so with its resolve function
      - the resolve function fixes the relocation referenced by the
        relocation index pushed by the 'puts' trampoline
      - the relocation entry tells the resolve function which symbol to
        search for and where to put the function pointer
          &gt; readelf -r &lt;main&gt;
            &gt;&gt; Relocation section '.rela.plt' at offset 0x4b8 contains 1 entry:
            &gt;&gt;   Offset          Info           Type           Sym. Value    Sym. Name + Addend
            &gt;&gt; 000000404018  000200000007 R_X86_64_JUMP_SLO 0000000000000000 puts@GLIBC_2.2.5 + 0
          - offset points to _GLOBAL_OFFSET_TABLE_[3]

      [0x00401040]&gt; pd 4 @ section..got.plt
                  ;-- section..got.plt:
                  ;-- .got.plt:    ; [22] -rw- section size 32 named .got.plt
                  ;-- _GLOBAL_OFFSET_TABLE_:
                  0x00404000      .qword 0x0000000000403e10 ; section..dynamic ; obj._DYNAMIC
                  0x00404008      .qword 0x0000000000000000
                  ; CODE XREF from section..plt @ +0x6
                  0x00404010      .qword 0x0000000000000000
                  ;-- reloc.puts:
                  ; CODE XREF from sym.imp.puts @ 0x401030
                  0x00404018      .qword 0x0000000000401036                  ; RELOC 64 puts

      [0x00401040]&gt; pd 6 @ section..plt
                  ;-- section..plt:
                  ;-- .plt:       ; [12] -r-x section size 32 named .plt
              ┌─&gt; 0x00401020      ff35e22f0000   push qword [0x00404008]
              ╎   0x00401026      ff25e42f0000   jmp qword [0x00404010]
              ╎   0x0040102c      0f1f4000       nop dword [rax]
      ┌ 6: int sym.imp.puts (const char *s);
      └       ╎   0x00401030      ff25e22f0000   jmp qword [reloc.puts]
              ╎   0x00401036      6800000000     push 0
              └─&lt; 0x0040103b      e9e0ffffff     jmp sym..plt
</code></pre>
<h1><a class="header" href="#git1" id="git1">git(1)</a></h1>
<h2><a class="header" href="#misc" id="misc">Misc</a></h2>
<pre><code class="language-markdown">  git add -p [&lt;file&gt;] ............ partial staging (interactive)
</code></pre>
<h2><a class="header" href="#remote" id="remote">remote</a></h2>
<pre><code class="language-markdown">  git remote -v .................. list remotes verbose (with URLs)
  git remote show [-n] &lt;remote&gt; .. list info for &lt;remote&gt; (like remote HEAD,
                                   remote branches, tracking mapping)
</code></pre>
<h2><a class="header" href="#branching" id="branching">branching</a></h2>
<pre><code class="language-markdown">  git branch [-a] ................ list available branches; -a to include
                                   remote branches
  git branch -vv ................. list branch &amp; annotate with head sha1 &amp;
                                   remote tracking branch
  git branch &lt;bname&gt; ............. create branch with name &lt;bname&gt;
  git checkout &lt;bname&gt; ........... switch to branch with name &lt;bname&gt;
  git push -u origin &lt;rbname&gt; .... push branch to origin (or other remote), and
                                   setup &lt;rbname&gt; as tracking branch
</code></pre>
<h2><a class="header" href="#resetting" id="resetting">resetting</a></h2>
<pre><code class="language-markdown">  git reset [opt] &lt;ref|commit&gt;
    opt:
      --mixed .................... resets index, but not working tree
      --hard ..................... matches the working tree and index to that
                                   of the tree being switched to any changes to
                                   tracked files in the working tree since
                                   &lt;commit&gt; are lost
  git reset HEAD &lt;file&gt; .......... remove file from staging
  git reset --soft HEAD~1 ........ delete most recent commit but keep work
  git reset --hard HEAD~1 ........ delete most recent commit and delete work
</code></pre>
<h2><a class="header" href="#tags" id="tags">tags</a></h2>
<pre><code class="language-markdown">  git tag -a &lt;tname&gt; -m &quot;descr&quot; ........ creates an annotated tag (full object
                                         containing tagger, date, ...)
  git tag -l ........................... list available tags
  git checkout tag/&lt;tname&gt; ............. checkout specific tag
  git checkout tag/&lt;tname&gt; -b &lt;bname&gt; .. checkout specific tag in a new branch
</code></pre>
<h2><a class="header" href="#diff" id="diff">diff</a></h2>
<pre><code class="language-markdown">  git diff HEAD:&lt;fname&gt; origin/HEAD:&lt;fname&gt; ... diff files for different refs
  git diff -U$(wc -l &lt;fname&gt;) &lt;fname&gt; ......... shows complete file with diffs
                                                instead of usual diff snippets
</code></pre>
<h2><a class="header" href="#log" id="log">log</a></h2>
<pre><code class="language-markdown">  git log --oneline .... shows log in single line per commit -&gt; alias for
                         '--pretty=oneline --abbrev-commit'
  git log --graph ...... text based graph of commit history
  git log --decorate ... decorate log with REFs
</code></pre>
<h2><a class="header" href="#patching" id="patching">patching</a></h2>
<pre><code class="language-markdown">  git format-patch &lt;opt&gt; &lt;since&gt;/&lt;revision range&gt;
    opt:
      -N ................... use [PATCH] instead [PATCH n/m] in subject when
                             generating patch description (for patches spanning
                             multiple commits)
      --start-number &lt;n&gt; ... start output file generation with &lt;n&gt; as start
                             number instead '1'
    since spcifier:
      -3 .................. e.g: create a patch from last three commits
      &lt;comit hash&gt; ........ create patch with commits starting after &lt;comit hash&gt;

  git am &lt;patch&gt; ......... apply patch and create a commit for it

  git apply --stat &lt;PATCH&gt; ... see which files the patch would change
  git apply --check &lt;PATCH&gt; .. see if the patch can be applied cleanly
  git apply &lt;PATCH&gt; .......... apply the patch locally without creating a commit

  # eg: generate patches for each commit from initial commit on
  git format-patch -N $(git rev-list --max-parents=0 HEAD)

  # generate single patch file from a certain commit/ref
  git format-patch &lt;COMMIT/REF&gt; --stdout &gt; my-patch.patch
</code></pre>
<h2><a class="header" href="#submodules" id="submodules">submodules</a></h2>
<pre><code class="language-markdown">  git submodule add &lt;url&gt; [&lt;path&gt;] .......... add new submodule to current project
  git clone --recursive &lt;url&gt; ............... clone project and recursively all
                                              submodules (same as using
                                              'git submodule update --init
                                              --recursive' after clone)
  git submodule update --init --recursive ... checkout submodules recursively
                                              using the commit listed in the
                                              super-project (in detached HEAD)
  git submodule update --remote &lt;submod&gt; .... fetch &amp; merge remote changes for
                                              &lt;submod&gt;, this will pull
                                              origin/HEAD or a branch specified
                                              for the submodule
</code></pre>
<h2><a class="header" href="#inspection" id="inspection">inspection</a></h2>
<pre><code class="language-markdown">  git ls-tree [-r] &lt;ref&gt; .... show git tree for &lt;ref&gt;, -r to recursively ls sub-trees
  git show &lt;obj&gt; ............ show &lt;obj&gt;
  git cat-file -p &lt;obj&gt; ..... print content of &lt;obj&gt;
</code></pre>
<h2><a class="header" href="#revision_range" id="revision_range">revision_range</a></h2>
<pre><code class="language-markdown">  HEAD ........ last commit
  HEAD~1 ...... last commit-1
  HEAD~N ...... last commit-N (linear backwards when in tree structure, check
                difference between HEAD^ and HEAD~)
  git rev-list --max-parents=0 HEAD ........... first commit
</code></pre>
<h1><a class="header" href="#gdb1" id="gdb1">gdb(1)</a></h1>
<h1><a class="header" href="#cli" id="cli">CLI</a></h1>
<pre><code class="language-markdown">  gdb [opts] [prg [-c coredump | -p pid]]
  gdb [opts] --args prg &lt;prg-args&gt;
    opts:
      -p &lt;pid&gt;        attach to pid
      -c &lt;coredump&gt;   use &lt;coredump&gt;
      -x &lt;file&gt;       execute script &lt;file&gt; before prompt
      -ex &lt;cmd&gt;       execute command &lt;cmd&gt; before prompt
      --tty &lt;tty&gt;     set I/O tty for debugee
</code></pre>
<h1><a class="header" href="#interactive-usage" id="interactive-usage">Interactive usage</a></h1>
<pre><code class="language-markdown">  tty &lt;tty&gt;
          Set &lt;tty&gt; as tty for debugee.
          Make sure nobody reads from target tty, easiest is to spawn a shell
          and run following in target tty:
          &gt; while true; do sleep 1024; done

  set follow-fork-mode &lt;child | parent&gt;
          Specify which process to follow when debuggee makes a fork(2)
          syscall.

  sharedlibrary [&lt;regex&gt;]
          Load symbols of shared libs loaded by debugee. Optionally use &lt;regex&gt;
          to filter libs for symbol loading.

  break [-qualified] &lt;sym&gt; thread &lt;tnum&gt;
          Set a breakpoint only for a specific thread.
          -qualified: Tred &lt;sym&gt; as fully qualified symbol (quiet handy to set
          breakpoints on C symbols in C++ contexts)

  rbreak &lt;regex&gt;
          Set breakpoints matching &lt;regex&gt;, where matching internally is done
          on: .*&lt;regex&gt;.*

  command [&lt;bp_list&gt;]
          Define commands to run after breakpoint hit. If &lt;bp_list&gt; is not
          specified attach command to last created breakpoint. Command block
          terminated with 'end' token.

          &lt;bp_list&gt;: Space separates list, eg 'command 2 5-8' to run command
          for breakpoints: 2,5,6,7,8.

  info functions [&lt;regex&gt;]
          List functions matching &lt;regex&gt;. List all functions if no &lt;regex&gt;
          provided.

  info variables [&lt;regex&gt;]
          List variables matching &lt;regex&gt;. List all variables if no &lt;regex&gt;
          provided.

  info handle [&lt;signal&gt;]
          Print how to handle &lt;signal&gt;. If no &lt;signal&gt; specified print for all
          signals.

  handle &lt;signal&gt; &lt;action&gt;
          Configure how gdb handles &lt;signal&gt; sent to debugee.
          &lt;action&gt;:
            stop/nostop       Catch signal in gdb and break.
            print/noprint     Print message when gdb catches signal.
            pass/nopass       Pass signal down to debugee.

  catch signal &lt;signal&gt;
          Create a catchpoint for &lt;signal&gt;.
</code></pre>
<h1><a class="header" href="#user-commands-macros" id="user-commands-macros">User commands (macros)</a></h1>
<pre><code class="language-markdown">  define &lt;cmd&gt;
    # cmds
  end

  document &lt;cmd&gt;
    # docu
  end

  help user-defined             List user defined commands.
  help &lt;cmd&gt;                    List documentation for command &lt;cmd&gt;.
</code></pre>
<h1><a class="header" href="#hooks" id="hooks">Hooks</a></h1>
<p>Gdb allows to create two types of command <code>hooks</code> which will be either executed
before or after a certain command.</p>
<pre><code class="language-markdown">  define hook-&lt;cmd&gt;             Run commands defined in hook before
    # cmds                      executing &lt;cmd&gt;.
  end

  define hookpost-&lt;cmd&gt;         Run commands defined in hookpost after
    # cmds                      executing &lt;cmd&gt;.
  end
</code></pre>
<h1><a class="header" href="#flows" id="flows">Flows</a></h1>
<h2><a class="header" href="#catch-sigsegv-and-execute-commands-on-occurrence" id="catch-sigsegv-and-execute-commands-on-occurrence">Catch SIGSEGV and execute commands on occurrence</a></h2>
<pre><code class="language-markdown">  catch signal SIGSEGV
  command
    bt
    c
  end
</code></pre>
<h2><a class="header" href="#run-backtrace-on-thread-1-batch-mode" id="run-backtrace-on-thread-1-batch-mode">Run <code>backtrace</code> on thread 1 (batch mode)</a></h2>
<pre><code class="language-markdown">  gdb --batch -ex 'thread 1' -ex 'bt' -p &lt;pid&gt;
</code></pre>
<h2><a class="header" href="#script-gdb-for-automating-debugging-sessions" id="script-gdb-for-automating-debugging-sessions">Script gdb for automating debugging sessions</a></h2>
<pre><code class="language-markdown"># run.gdb
  set pagination off

  break mmap
  command
    info reg rdi rsi rdx
    bt
    c
  end

  #initial drop
  c
</code></pre>
<p>This script can be used as:</p>
<pre><code class="language-markdown">  gdb -p &lt;pid&gt; -x ./run.gdb  --batch &amp;&gt; run.log
</code></pre>
<h2><a class="header" href="#workaround-command--finish-bug" id="workaround-command--finish-bug">Workaround <code>command + finish</code> bug</a></h2>
<p>When using <code>finish</code> action inside a <code>command</code> block, actions after <code>finish</code> are
not executed anymore. To workaround that bug one can create a wrapper function
which calls <code>finish</code>.</p>
<pre><code class="language-markdown">  define handler
  bt
  finish
  info reg rax
  end

  command
  handler
  end
</code></pre>
<h1><a class="header" href="#radare21" id="radare21">radare2(1)</a></h1>
<h2><a class="header" href="#print" id="print">print</a></h2>
<pre><code class="language-markdown">
  pd &lt;n&gt; [@ &lt;addr&gt;]     # print disassembly for &lt;n&gt; instructions
                        # with optional temporary seek to &lt;addr&gt;
</code></pre>
<h2><a class="header" href="#flags" id="flags">flags</a></h2>
<pre><code class="language-markdown">  fs            # list flag-spaces
  fs &lt;fs&gt;       # select flag-space &lt;fs&gt;
  f             # print flags of selected flag-space
</code></pre>
<h2><a class="header" href="#help" id="help">help</a></h2>
<pre><code class="language-markdown">  ?*~&lt;kw&gt;       # '?*' list all commands and '~' grep for &lt;kw&gt;
  ?*~...        # '..' less mode /'...' interactive search
</code></pre>
<h2><a class="header" href="#relocation" id="relocation">relocation</a></h2>
<pre><code class="language-markdown">  &gt; r2 -B &lt;baddr&gt; &lt;exe&gt;         # open &lt;exe&gt; mapped to addr &lt;baddr&gt;
  oob &lt;addr&gt;                    # reopen current file at &lt;baddr&gt;
</code></pre>
<h1><a class="header" href="#emacs1" id="emacs1">emacs(1)</a></h1>
<h2><a class="header" href="#help-1" id="help-1">help</a></h2>
<pre><code class="language-markdown">  C-h f                 describe function
  C-h b                 list buffer available keymaps
  &lt;kseq&gt; C-h            list possible keymaps with &lt;kseq&gt;
                        eg C-x C-h -&gt; list keymaps beginning with C-x
</code></pre>
<h2><a class="header" href="#window" id="window">window</a></h2>
<pre><code class="language-markdown">  C-x 0         kill focused window
  C-x 1         kill all other windows
  C-x 2         split horizontal
  C-x 3         split vertical
</code></pre>
<h2><a class="header" href="#blockrect" id="blockrect">block/rect</a></h2>
<pre><code class="language-markdown">  C-x &lt;SPC&gt;                     activate rectangle-mark-mode
  M-x string-rectangle &lt;RET&gt;    insert text in marked rect
</code></pre>
<h2><a class="header" href="#mass-edit" id="mass-edit">mass edit</a></h2>
<pre><code class="language-makrdown">  C-x h                                 mark whole buffer (mark-whole-buffer)
  M-x delete-matching-line &lt;RET&gt;        delete lines matching regex
  M-x %                                 search &amp; replace region (query-replace)
  C-M-x %                               search &amp; replace regex (query-replace-regexp)
</code></pre>
<h2><a class="header" href="#grep" id="grep">grep</a></h2>
<pre><code class="language-markdown">  M-x find-grep &lt;RET&gt;           run find-grep result in *grep* buffer
  n/p                           navigate next/previous match in *grep* buffer
</code></pre>
<h2><a class="header" href="#lisp-mode" id="lisp-mode">lisp mode</a></h2>
<pre><code class="language-markdown">  M-x lisp-interaction-mode     activate lisp mode
  C-M-x                         evaluate top expr under cursor
  C-x C-e                       eval-last-sexp
  C-u C-x C-e                   eval-last-sexp and prints result in current buffer
</code></pre>
<h2><a class="header" href="#narrow" id="narrow">narrow</a></h2>
<pre><code class="language-markdown">  C-x n n               show only focused region (narrow)
  C-x n w               show whole buffer (wide)
</code></pre>
<h2><a class="header" href="#org" id="org">org</a></h2>
<pre><code class="language-markdown">  M-up/M-down           re-arrange items in same hierarchy
  M-left/M-right        change item hierarchy
  C-RET                 create new item below current
  C-S-RET               create new TODO item below current
  S-left/S-right        cycle TODO states
</code></pre>
<h3><a class="header" href="#org-source" id="org-source">org source</a></h3>
<pre><code class="language-markdown">  &lt;s TAB                generate a source block
  C-c '                 edit source block (in lang specific buffer)
  C-c C-c               eval source block
</code></pre>
<h1><a class="header" href="#fish1" id="fish1">fish(1)</a></h1>
<h2><a class="header" href="#keymaps" id="keymaps">keymaps</a></h2>
<pre><code class="language-markdown">  Shift-Tab ........... tab-completion with search
  Alt-Up / Alt-Down ... search history with token under the cursor
  Alt-l ............... list content of dir under cursor
  Alt-p ............... append '2&gt;&amp;1 | less;' to current cmdline
</code></pre>
<h2><a class="header" href="#debug" id="debug">debug</a></h2>
<pre><code class="language-markdown">  status print-stack-trace .. prints function stacktrace (can be used in scripts)
  breakpoint ................ halt script execution and gives shell (C-d | exit
                              to continue)
</code></pre>
<h1><a class="header" href="#strace1" id="strace1">strace(1)</a></h1>
<pre><code class="language-markdown">strace [opts] [prg]
  -f .......... follow child processes on fork(2)
  -p &lt;pid&gt; .... attach to running process
  -s &lt;size&gt; ... max string size (default: 32)
  -e &lt;expr&gt; ... expression for trace filtering
  -o &lt;file&gt; ... log output into &lt;file&gt;
  -c .......... dump syscall statitics at the end
</code></pre>
<pre><code class="language-markdown">&lt;expr&gt;:
  trace=syscall[,syscall] .... trace only syscall listed
  trace=file ................. trace all syscall that take a filename as arg
  trace=process .............. trace process management related syscalls
  trace=signal ............... trace signal related syscalls
  signal ..................... trace signals delivered to the process
</code></pre>
<h1><a class="header" href="#examples" id="examples">Examples</a></h1>
<p>Trace <code>'open &amp; socket</code> syscalls for a running process + childs.</p>
<pre><code class="language-markdown">strace -f -p &lt;pid&gt; -e trace=open,socket
</code></pre>
<p>Trace signals delivered to a running process.</p>
<pre><code class="language-markdown">strace -f -p &lt;pid&gt; -e signal
</code></pre>
<h1><a class="header" href="#lsof8" id="lsof8">lsof(8)</a></h1>
<pre><code class="language-markdown">lsof
  -a ......... AND slection filters instead ORing (OR: default)
  -p &lt;pid&gt; ... list open file descriptors for process
  +fg ........ show file flags for file descripros
  -n ......... don't convert network addr to hostnames
  -P ......... don't convert network port to know service names
  -i &lt;@h[:p]&gt;. show connections to h (hostname|ip addr) with optional port p
</code></pre>
<pre><code class="language-markdown">file flags:
  R/W/RW ..... read/write/read-write
  CR ......... create
  AP ......... append
  TR ......... truncate
</code></pre>
<h1><a class="header" href="#examples-1" id="examples-1">Examples</a></h1>
<p>Show open files with file flags:</p>
<pre><code class="language-markdown">lsof +fg -p &lt;pid&gt;
</code></pre>
<p>Show open tcp connections from user:</p>
<pre><code class="language-markdown">lsof -a -u $USER -i tcp
</code></pre>
<p>Show open connections to 'localhost' for user:</p>
<pre><code class="language-markdown">lsof -a -u $USER -i @localhost
</code></pre>
<h1><a class="header" href="#pidstat1" id="pidstat1">pidstat(1)</a></h1>
<p>Trace minor/major page faults.</p>
<pre><code class="language-markdown">pidstat -r -p &lt;pid&gt; [interval]
  minor_pagefault: happens when the page needed is already in memory but not
                   allocated to the faulting process, in that case the kernel
                   only has to create a new page-table entry pointing to the
                   shared physical page
  major_pagefault: happends when the page needed is NOT in memory, the kernel
                   has to create a new page-table entry and populate the
                   physical page
</code></pre>
<h1><a class="header" href="#usrbintime1" id="usrbintime1">/usr/bin/time(1)</a></h1>
<pre><code class="language-markdown"># statistics of process run
/usr/bin/time -v &lt;cmd&gt;
</code></pre>
<h1><a class="header" href="#pmap1" id="pmap1">pmap(1)</a></h1>
<pre><code class="language-markdown">pmap &lt;pid&gt;
  ............. dump virtual memory map of process.
                compared to /proc/&lt;pid&gt;/maps it shows the size of the mappings
</code></pre>
<h1><a class="header" href="#pstack1" id="pstack1">pstack(1)</a></h1>
<pre><code class="language-markdown">pstack &lt;pid&gt;
  ............. dump current stack of process + threads
</code></pre>
<h1><a class="header" href="#perf1" id="perf1">perf(1)</a></h1>
<pre><code class="language-markdown">perf list
  ......... show supported hw/sw events

perf stat
  -p &lt;pid&gt; .. show stats for running process
  -I &lt;ms&gt; ... show stats periodically over interval &lt;ms&gt;
  -e &lt;ev&gt; ... filter for events

perf top
  -p &lt;pid&gt; .. show stats for running process
  -F &lt;hz&gt; ... sampling frequency
  -K ........ hide kernel threads

perf record
  -p &lt;pid&gt; ............... record stats for running process
  -F &lt;hz&gt; ................ sampling frequency
  --call-graph &lt;method&gt; .. [fp, dwarf, lbr] method how to caputre backtrace
                           fp   : use frame-pointer, need -fno-omit-frame-pointer
                           dwarf: use .cfi debug information
                           lbr  : use hardware last branch record facility
  -g ..................... short-hand for --call-graph fp
  -e &lt;ev&gt; ................ filter for events

perf report
  -n .................... annotate symbols with nr of samples
  --stdio ............... report to stdio, if not presen tui mode
  -g graph,0.5,caller ... show caller based call chains with value &gt;0.5
</code></pre>
<h2><a class="header" href="#useful-perf-events" id="useful-perf-events">Useful <code>perf</code> events</a></h2>
<pre><code class="language-markdown">useful &lt;ev&gt;:
  page-faults
  minor-faults
  major-faults
  cpu-cycles`
  task-clock
</code></pre>
<h2><a class="header" href="#a-hrefhttpsgithubcombrendangreggflamegraphflamegrapha" id="a-hrefhttpsgithubcombrendangreggflamegraphflamegrapha"><a href="https://github.com/brendangregg/FlameGraph"><code>Flamegraph</code></a></a></h2>
<pre><code class="language-markdown"># flamegraph for single event trace
perf record -g -p &lt;pid&gt; -e cpu-cycles
perf script | FlameGraph/stackcollapse-perf.pl | FlameGraph/flamegraph.pl &gt; cycles-flamegraph.svg

# flamegraphs for multiple events trace
perf record -g -p &lt;pid&gt; -e cpu-cycles,page-faults
perf script --per-event-dump
# fold &amp; generate as above
</code></pre>
<h1><a class="header" href="#oprofile" id="oprofile">OProfile</a></h1>
<pre><code class="language-markdown">operf -g -p &lt;pid&gt;
  -g ...... caputre call-graph information

opreport [opt] FILE
     ...... show time spent per binary image
  -l ...... show time spent per symbol
  -c ...... show callgraph information (see below)
  -a ...... add column with time spent accumulated over child nodes

ophelp
     ...... show supported hw/sw events
</code></pre>
<h1><a class="header" href="#od1" id="od1">od(1)</a></h1>
<pre><code class="language-markdown">  od [opts] &lt;file&gt;
    -An         don't print addr info
    -tx4        print hex in 4 byte chunks
    -ta         print as named character
    -tc         printable chars or backslash escape
    -w4         print 4 bytes per line
    -j &lt;n&gt;      skip &lt;n&gt; bytes from &lt;file&gt; (hex if start with 0x)
    -N &lt;n&gt;      dump &lt;n&gt; bytes (hex of start with 0x)
</code></pre>
<h2><a class="header" href="#ascii-chars-to-hex-string" id="ascii-chars-to-hex-string">ascii chars to hex string</a></h2>
<pre><code class="language-markdown">  echo -n AAAABBBB | od -An -w4 -tx4
    &gt;&gt; 41414141
    &gt;&gt; 42424242

  echo -n '\x7fELF\n' | od -tx1 -ta -tc
    &gt;&gt; 0000000  7f  45  4c  46  0a      # tx1
    &gt;&gt;         del   E   L   F  nl      # ta
    &gt;&gt;         177   E   L   F  \n      # tc
</code></pre>
<h2><a class="header" href="#extract-part-of-file-eg-rodata-section-form-elf" id="extract-part-of-file-eg-rodata-section-form-elf">extract part of file (eg .rodata section form ELF)</a></h2>
<pre><code class="language-markdown">  readelf -W -S foo
    &gt;&gt; Section Headers:
    &gt;&gt; [Nr] Name              Type            Address          Off    Size   ES Flg Lk Inf Al
    &gt;&gt; ...
    &gt;&gt; [15] .rodata           PROGBITS        00000000004009c0 0009c0 000030 00   A  0   0 16
  od -j 0x0009c0 -N 0x30 -tx4 -w4 foo
    &gt;&gt; 0004700 00020001
    &gt;&gt; 0004704 00000000
    &gt;&gt; *
    &gt;&gt; 0004740 00000001
    &gt;&gt; 0004744 00000002
    &gt;&gt; 0004750 00000003
    &gt;&gt; 0004754 00000004
</code></pre>
<h1><a class="header" href="#xxd1" id="xxd1">xxd(1)</a></h1>
<pre><code class="language-markdown">  xxd [opts]
    -p          dump continuous hexdump
    -r          convert hexdump into binary ('revert')
    -e          dump as little endian mode
    -i          output as C array
</code></pre>
<h2><a class="header" href="#from-ascii-to-hex-stream" id="from-ascii-to-hex-stream">from ascii to hex stream</a></h2>
<pre><code class="language-markdown">  echo -n 'aabb' | xxd -p
    &gt;&gt; 61616262
</code></pre>
<h2><a class="header" href="#from-hex-stream-to-binary-stream" id="from-hex-stream-to-binary-stream">from hex stream to binary stream</a></h2>
<pre><code class="language-markdown">  echo -n '61616262' | xxd -p -r
    &gt;&gt; aabb
</code></pre>
<h2><a class="header" href="#ascii-to-binary" id="ascii-to-binary">ascii to binary</a></h2>
<pre><code class="language-markdown">  echo -n '\x7fELF' | xxd -p | xxd -p -r | file -p -
    &gt;&gt; ELF
</code></pre>
<h2><a class="header" href="#ascii-to-c-array-hex-encoded" id="ascii-to-c-array-hex-encoded">ascii to C array (hex encoded)</a></h2>
<pre><code class="language-markdown">  xxd -i &lt;(echo -n '\x7fELF')
    &gt;&gt; unsigned char _proc_self_fd_11[] = {
    &gt;&gt;   0x7f, 0x45, 0x4c, 0x46
    &gt;&gt; };
    &gt;&gt; unsigned int _proc_self_fd_11_len = 4;
</code></pre>
<h1><a class="header" href="#readelf1" id="readelf1">readelf(1)</a></h1>
<pre><code class="language-markdown">  readelf [opts] &lt;elf&gt;
    -W|--wide     wide output, dont break output at 80 chars
    -h            print ELF header
    -S            print section headers
    -l            print program headers + segment mapping
    -d            print .dynamic section (dynamic link information)
    --syms        print symbol tables (.symtab .dynsym)
    --dyn-syms    print dynamic symbol table (exported symbols for dynamic linker)
    -r            print relocation sections (.rel.*, .rela.*)
</code></pre>
<h1><a class="header" href="#objdump1" id="objdump1">objdump(1)</a></h1>
<pre><code class="language-markdown">  objdump [opts] &lt;elf&gt;
    -M intel                use intil syntax
    -d                      disassemble text section
    -D                      disassemble all sections
    -S                      mix disassembly with source code
    -C                      demangle
    -j &lt;section&gt;            display info for section
    --[no-]show-raw-insn    [dont] show object code next to disassembly
</code></pre>
<h2><a class="header" href="#disassemble-plt-section" id="disassemble-plt-section">Disassemble .plt section</a></h2>
<pre><code class="language-markdown">  objdump -j .plt -d &lt;elf&gt;
</code></pre>
<h1><a class="header" href="#nm1" id="nm1">nm(1)</a></h1>
<pre><code class="language-markdown">  nm [opts] &lt;elf&gt;
    -C          demangle
    -u          undefined only
</code></pre>
<h1><a class="header" href="#cfilt1" id="cfilt1">c++filt(1)</a></h1>
<h2><a class="header" href="#demangle-symbol" id="demangle-symbol">demangle symbol</a></h2>
<pre><code class="language-markdown">  c++-filt &lt;symbol_str&gt;
</code></pre>
<h2><a class="header" href="#demangle-stream-eg-dynamic-symbol-table" id="demangle-stream-eg-dynamic-symbol-table">demangle stream (eg dynamic symbol table)</a></h2>
<pre><code class="language-markdown">  readelf -W --dyn-syms &lt;elf&gt; | c++filt
</code></pre>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                        

                        

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                

                
            </nav>

        </div>

        

        

        
        
        
        <script type="text/javascript">
            window.playpen_copyable = true;
        </script>
        

        

        
        <script src="elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="searcher.js" type="text/javascript" charset="utf-8"></script>
        

        <script src="clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        

        
        
        <script type="text/javascript">
        window.addEventListener('load', function() {
            window.setTimeout(window.print, 100);
        });
        </script>
        
        

    </body>
</html>
